<!DOCTYPE html>
<html>
  <head>
    <title>scratch to js</title>
    <meta charset="UTF-8">
    <meta name="description" content="turns project.json to javascripts"/>
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">
    <style media="screen">
      body {
        background-color: #E8EDF1;
        font-family: 'Inconsolata', monospace;
        font-size: 15px;
        line-height: 1;
      }
      canvas, textarea {
        height: 360px;
        width: 480px;
        background-color: white;
        border-radius: 5px;
      }
      textarea {
        box-sizing: border-box;
        -moz-tab-size: 2;
        -o-tab-size: 2;
        tab-size: 2;
        transition: box-shadow .2s;
      }
      textarea:focus {
        box-shadow: 0 0 0 3px rgba(0,160,255,0.3);
      }
    </style>
  </head>
  <body>
    <canvas id="c" width="480" height="360"></canvas>
    <p id='p'>Use the sheepmenu to press the green flag.</p>

    <script src="../../sheep.js"></script>
    <script>
// https://wiki.scratch.mit.edu/wiki/Scratch_File_Format_(2.0)#Format
var canvas=document.querySelector('#c'),
c=canvas.getContext('2d'),
pxr=SHEEP.pixelratio(),
scratch,
sprites={
  _STAGE_:{
    lists:{},
    vars:{}
  }
},
userdata={mousex:0,mousey:0,mousedown:false,keys:{}};
var p=document.querySelector('#p');
function loguserdata() {
  p.textContent=`mouse ${userdata.mousedown?'down':'up'} (${userdata.mousex},${userdata.mousey}) and keys ${(_=>{
    var t=[];
    for (var span in userdata.keys) if (userdata.keys[span]) t.push(span);
    return t.join(' ');
  })()}`;
}
document.onmousemove=e=>{
  userdata.mousex=e.clientX-canvas.getBoundingClientRect().left-240;
  userdata.mousey=180-e.clientY+canvas.getBoundingClientRect().top;
};
document.onmousedown=e=>{
  userdata.mousedown=true;
};
document.onmouseup=e=>{
  userdata.mousedown=false;
};
document.onkeydown=e=>{
  userdata.keys[e.keyCode]=true;
  if (e.keyCode===9) {
    e.preventDefault();
    return false;
  }
};
document.onkeyup=e=>{
  userdata.keys[e.keyCode]=false;
};
canvas.width*=pxr;
canvas.height*=pxr;
SHEEP.ajax('http://projects.scratch.mit.edu/internalapi/project/115618276/get/',e=>scratch=JSON.parse(e)); // structure mania 115618276  test 155817190  penland 112971638
function doscratch(block,oops) {
  if (typeof block!=='object') return block;
  else {
    var oops=oops||null;
    switch (block[0]) {
      case '-':
        var t=doscratch(block[1],oops),b=doscratch(block[2],oops);
        return Number(doscratch(block[1],oops))-Number(doscratch(block[2],oops));
      case '*':
        return Number(doscratch(block[1],oops))*Number(doscratch(block[2],oops));
      case '/':
        return Number(doscratch(block[1],oops))/Number(doscratch(block[2],oops));
      case '+':
        return Number(doscratch(block[1],oops))+Number(doscratch(block[2],oops));
      case '%':
        return Number(doscratch(block[1],oops))%Number(doscratch(block[2],oops));
      case '&':
        return doscratch(block[1],oops)&&doscratch(block[2],oops);
      case '|':
        return doscratch(block[1],oops)||doscratch(block[2],oops);
      case '<':
        var b1=doscratch(block[1],oops),b2=doscratch(block[2],oops);
        if (isNaN(Number(b1))||isNaN(Number(b2))) return b1<b2;
        else return Number(b1)<Number(b2);
      case '>':
        var b1=doscratch(block[1],oops),b2=doscratch(block[2],oops);
        if (isNaN(Number(b1))||isNaN(Number(b2))) return b1>b2;
        else return Number(b1)>Number(b2);
      case '=':
        var b1=doscratch(block[1],oops),b2=doscratch(block[2],oops);
        if (b1===''&&(b2===0||b2===false)) return false;
        else if (b2===''&&(b1===0||b1===false)) return false;
        else if (typeof b2==='string'&&typeof b1==='string') return b1.toLowerCase()===b2.toLowerCase();
        else return b1==b2;
      case 'abs':
        return Math.abs(doscratch(block[1],oops));
      case 'append:toList:':
        var list=doscratch(block[2],oops);
        if (oops.lists[list]) oops.lists[list].push(doscratch(block[1],oops));
        else if (sprites._STAGE_.lists[list]) sprites._STAGE_.lists[list].push(doscratch(block[1],oops));
        else oops.lists[list]=[doscratch(block[1],oops)];
        break;
      case 'changeVar:by:':
        var vari=doscratch(block[1],oops);
        if (oops.vars[vari]!==undefined) oops.vars[vari]+=doscratch(block[2],oops);
        else if (sprites._STAGE_.vars[vari]!==undefined) sprites._STAGE_.vars[vari]+=doscratch(block[2],oops);
        else oops.vars[vari]=doscratch(block[2],oops);
        break;
      case 'setVar:to:':
        var vari=doscratch(block[1],oops);
        if (oops.vars[vari]!==undefined||sprites._STAGE_.vars[vari]===undefined) oops.vars[vari]=doscratch(block[2],oops);
        else if (sprites._STAGE_.vars[vari]!==undefined) sprites._STAGE_.vars[vari]=doscratch(block[2],oops);
        break;
      case 'readVariable':
        var vari=block[1];
        if (oops.vars[vari]!==undefined) return oops.vars[vari];
        else if (sprites._STAGE_.vars[vari]!==undefined) return sprites._STAGE_.vars[vari];
        else return 0;
      case 'changePenSizeBy:':
        oops.pensize+=doscratch(block[1],oops);
        if (oops.pensize<1) oops.pensize=1;
        if (oops.pensize>256) oops.pensize=256;
        break;
      case 'deleteLine:ofList:':
        var t=doscratch(block[1],oops),
        list=doscratch(block[2],oops);
        if (t==='all') {
          if (oops.lists[list]) oops.lists[list]=[];
          else if (sprites._STAGE_.lists[list]) sprites._STAGE_.lists[list]=[];
        } else if (t==='none') {
          if (oops.lists[list]) oops.lists[list].splice(-1,1);
          else if (sprites._STAGE_.lists[list]) sprites._STAGE_.lists[list].splice(-1,1);
        } else {
          if (oops.lists[list]) oops.lists[list].splice(Number(t)-1,1);
          else if (sprites._STAGE_.lists[list]) sprites._STAGE_.lists[list].splice(Number(t)-1,1);
        }
        break;
      case 'call':
        if (oops.custs[block[1]]!==undefined) dothe(oops.code[oops.custs[block[1]]],oops,block.slice(2));
        break;
      case 'doRepeat':
        var iterations=Number(doscratch(block[1],oops));
        for (var i=0;i<iterations;i++) for (var j=0;j<block[2].length;j++) doscratch(block[2][j],oops);
        break;
      case 'doForever':
        var stringified=JSON.stringify(block[1]);
        if (!oops.forevers[stringified]) {
          oops.forevers[stringified]=true;
          oops.forevers.push(block[1]);
          for (var i=0;i<block[1].length;i++) doscratch(block[1][i],oops);
        }
        break;
      case 'mousePressed':
        return userdata.mousedown;
      case 'mouseX':
        return userdata.mousex;
      case 'mouseY':
        return userdata.mousey;
      case 'keyPressed:':
        switch (doscratch(block[1],oops)) {
          case '\r':
            return userdata.keys[13];
          case '\t':
            return userdata.keys[9];
          case '\u0008':
            return userdata.keys[8];
          case '\u001b':
            return userdata.keys[27];
          case '':
            return userdata.keys[46];
          case '':
            var t=[16,17,18,91,93,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135];
            for (var i=0;i<t.length;i++) if (userdata.keys[t[i]]) return true;
            return false;
          default:
            //
        }
        break;
      case 'computeFunction:of:':
        var n=Number(doscratch(block[2],oops));
        switch (doscratch(block[1],oops)) {
          case 'abs': return Math.abs(n);
          case 'floor': return Math.floor(n);
          case 'ceiling': return Math.ceil(n);
          case 'sqrt': return Math.sqrt(n);
          case 'sin': return Math.sin(n*(Math.PI/180));
          case 'cos': return Math.cos(n*(Math.PI/180));
          case 'tan': return Math.tan(n*(Math.PI/180));
          case 'asin': return Math.asin(n)*(180/Math.PI);
          case 'acos': return Math.acos(n)*(180/Math.PI);
          case 'atan': return Math.atan(n)*(180/Math.PI);
          case 'ln': return Math.log(n);
          case 'log': return Math.log10(n);
          case 'e ^': return Math.E**n;
          case '10 ^': return 10**n;
        }
        break;
      case 'clearPenTrails':
        canvas.width=canvas.width;
        c.translate(240*pxr,canvas.height-180*pxr);
        c.scale(pxr,-pxr);
        c.lineCap='round';
        c.lineJoin='round';
        c.lineWidth=oops.pensize;
        c.strokeStyle=oops.pencolour;
        break;
      case 'doIf':
        if (doscratch(block[1],oops)) for (var i=0;i<block[2].length;i++) doscratch(block[2][i],oops);
        break;
      case 'doIfElse':
        if (doscratch(block[1],oops)) for (var i=0;i<block[2].length;i++) doscratch(block[2][i],oops);
        else for (var i=0;i<block[3].length;i++) doscratch(block[3][i],oops);
        break;
      case 'lineCountOfList:':
        var list=doscratch(block[1],oops);
        if (oops.lists[list]) return oops.lists[list].length;
        else if (sprites._STAGE_.lists[list]) return sprites._STAGE_.lists[list].length;
        else {
          oops.lists[list]=[];
          return 0;
        }
      case 'contentsOfList:':
        var list=doscratch(block[1],oops);
        if (oops.lists[list]) list=oops.lists[list].length;
        else if (sprites._STAGE_.lists[list]) list=sprites._STAGE_.lists[list].length;
        else {
          oops.lists[list]=[];
          return '';
        }
        if ((_=>{
          for (var i=0;i<list.length;i++) if (list[i].toString().length!==1) return false;
          return true;
        })()) return list.join('');
        else list.join(' ');
      case 'setLine:ofList:to:':
        var list=doscratch(block[2],oops),
        line=Number(doscratch(block[1],oops));
        if (oops.lists[list]) {
          if (line==='last') oops.lists[list][oops.lists[list].length-1]=doscratch(block[3],oops);
          else if (line==='random') oops.lists[list][Math.floor(Math.random()*oops.lists[list].length)]=doscratch(block[3],oops);
          else if (line<=oops.lists[list].length) oops.lists[list][line-1]=doscratch(block[3],oops);
        }
        else if (sprites._STAGE_.lists[list]) {
          if (line==='last') sprites._STAGE_.lists[list][sprites._STAGE_.lists[list].length-1]=doscratch(block[3],oops);
          else if (line==='random') sprites._STAGE_.lists[list][Math.floor(Math.random()*sprites._STAGE_.lists[list].length)]=doscratch(block[3],oops);
          else if (line<=sprites._STAGE_.lists[list].length) sprites._STAGE_.lists[list][line-1]=doscratch(block[3],oops);
        }
        else oops.lists[list]=[];
        break;
      case 'getLine:ofList:':
        var list=doscratch(block[2],oops),
        line=Number(doscratch(block[1],oops));
        if (oops.lists[list]) {
          if (line==='last') return oops.lists[list][oops.lists[list].length-1];
          else if (line==='random') return oops.lists[list][Math.floor(Math.random()*oops.lists[list].length)];
          else if (line<=oops.lists[list].length&&line>0) return oops.lists[list][line-1];
          else return '';
        }
        else if (sprites._STAGE_.lists[list]) {
          if (line==='last') return sprites._STAGE_.lists[list][sprites._STAGE_.lists[list].length-1];
          else if (line==='random') return sprites._STAGE_.lists[list][Math.floor(Math.random()*sprites._STAGE_.lists[list].length)];
          else if (line<=sprites._STAGE_.lists[list].length&&line>0) return sprites._STAGE_.lists[list][line-1];
          else return '';
        }
        else {
          oops.lists[list]=[];
          return '';
        }
      case 'insert:at:ofList:':
        var list=doscratch(block[3],oops),
        line=Number(doscratch(block[2],oops));
        if (oops.lists[list]) {
          if (line==='last') oops.lists[list].splice(oops.lists[list].length-1,0,doscratch(block[2],oops));
          else if (line==='random') oops.lists[list].splice(Math.floor(Math.random()*oops.lists[list].length),0,doscratch(block[2],oops));
          else if (line<oops.lists[list].length+2&&line>0) oops.lists[list].splice(line-1,0,doscratch(block[2],oops));
        }
        else if (sprites._STAGE_.lists[list]) {
          if (line==='last') return sprites._STAGE_.lists[list].splice(sprites._STAGE_.lists[list].length-1,0,doscratch(block[2],oops));
          else if (line==='random') return sprites._STAGE_.lists[list].splice(Math.floor(Math.random()*sprites._STAGE_.lists[list].length),0,doscratch(block[2],oops));
          else if (line<sprites._STAGE_.lists[list].length+2&&line>0) return sprites._STAGE_.lists[list].splice(line-1,0,doscratch(block[2],oops));
        }
        else {
          if (line==='last'||line==='random'||line===1) oops.lists[list]=[doscratch(block[2],oops)];
          else oops.lists[list]=[];
        }
      case 'list:contains:':
        var list=doscratch(block[1],oops),
        test=doscratch(block[2],oops);
        if (oops.lists[list]) list=oops.lists[list];
        else if (sprites._STAGE_.lists[list]) list=sprites._STAGE_.lists[list];
        else {
          oops.lists[list]=[];
          return false;
        }
        for (var i=0;i<list.length;i++) {
          if (list[i]===''&&(test===0||test===false));
          else if (test===''&&(list[i]===0||list[i]===false));
          else if (typeof test==='string'&&typeof list[i]==='string') {
            if (list[i].toLowerCase()===test.toLowerCase()) return true;
          }
          else if (list[i]==test) return true;
        }
        return false;
        break;
      case 'penColor:':
        var colour=doscratch(block[1],oops);
        if (colour<0) oops.pencolour=16777216+colour;
        else oops.pencolour=colour;
        c.strokeStyle='#'+('00000'+oops.pencolour.toString(16)).slice(-6);
        break;
      case 'penSize:':
        oops.pensize=doscratch(block[1],oops);
        if (oops.pensize>256) oops.pensize=256;
        else if (oops.pensize<1) oops.pensize=1;
        c.lineWidth=oops.pensize;
        break;
      case 'changePenSizeBy:':
        oops.pensize+=doscratch(block[1],oops);
        if (oops.pensize>256) oops.pensize=256;
        else if (oops.pensize<1) oops.pensize=1;
        c.lineWidth=oops.pensize;
        break;
      case 'setPenHueTo:':
        var hsl=convertcolours.dectohsl(oops.pencolour);
        hsl.h=Number(doscratch(block[1],oops));
        if (isNaN(hsl.h)) hsl.h=0;
        hsl.s=100;
        oops.pencolour=convertcolours.hsltodec(hsl);
        c.strokeStyle='#'+('00000'+oops.pencolour.toString(16)).slice(-6);
        break;
      case 'changePenHueBy:':
        var hsl=convertcolours.dectohsl(oops.pencolour);
        hsl.h+=Number(doscratch(block[1],oops));
        if (isNaN(hsl.h)) hsl.h=0;
        hsl.s=100;
        oops.pencolour=convertcolours.hsltodec(hsl);
        c.strokeStyle='#'+('00000'+oops.pencolour.toString(16)).slice(-6);
        break;
      case 'setPenShadeTo:':
        var hsl=convertcolours.dectohsl(oops.pencolour);
        hsl.l=Number(doscratch(block[1],oops))%200;
        if (isNaN(hsl.l)) hsl.l=0;
        if (hsl.l>100) hsl.l=100-hsl.l;
        hsl.s=100;
        oops.pencolour=convertcolours.hsltodec(hsl);
        c.strokeStyle='#'+('00000'+oops.pencolour.toString(16)).slice(-6);
        break;
      case 'changePenShadeBy:':
        var hsl=convertcolours.dectohsl(oops.pencolour);
        hsl.l+=Number(doscratch(block[1],oops));
        hsl%=200;
        if (isNaN(hsl.l)) hsl.l=0;
        if (hsl.l>100) hsl.l=100-hsl.l;
        hsl.s=100;
        oops.pencolour=convertcolours.hsltodec(hsl);
        c.strokeStyle='#'+('00000'+oops.pencolour.toString(16)).slice(-6);
        break;
      case 'concatenate:with:':
        return doscratch(block[1],oops).toString()+doscratch(block[2],oops).toString();
        break;
      case 'changeXposBy:':
        if (oops.pendown) {
          c.beginPath();
          c.moveTo(oops.x,oops.y);
        }
        oops.x+=Number(doscratch(block[1],oops));
        if (oops.pendown) {
          c.lineTo(oops.x,oops.y);
          c.stroke();
        }
        break;
      case 'changeYposBy:':
        if (oops.pendown) {
          c.beginPath();
          c.moveTo(oops.x,oops.y);
        }
        oops.y+=Number(doscratch(block[1],oops));
        if (oops.pendown) {
          c.lineTo(oops.x,oops.y);
          c.stroke();
        }
        break;
      case 'xpos:':
        if (oops.pendown) {
          c.beginPath();
          c.moveTo(oops.x,oops.y);
        }
        oops.x=Number(doscratch(block[1],oops));
        if (oops.pendown) {
          c.lineTo(oops.x,oops.y);
          c.stroke();
        }
        break;
      case 'ypos:':
        if (oops.pendown) {
          c.beginPath();
          c.moveTo(oops.x,oops.y);
        }
        oops.y=Number(doscratch(block[1],oops));
        if (oops.pendown) {
          c.lineTo(oops.x,oops.y);
          c.stroke();
        }
        break;
      case 'gotoX:y:':
        if (oops.pendown) {
          c.beginPath();
          c.moveTo(oops.x,oops.y);
        }
        oops.x=Number(doscratch(block[1],oops));
        oops.y=Number(doscratch(block[2],oops));
        if (oops.pendown) {
          c.lineTo(oops.x,oops.y);
          c.stroke();
        }
        break;
      case 'gotoSpriteOrMouse:':
        if (oops.pendown) {
          c.beginPath();
          c.moveTo(oops.x,oops.y);
        }
        var pos=doscratch(block[1],oops);
        if (pos==='_mouse_') {
          oops.x=userdata.mousex;
          oops.y=userdata.mousey;
        } else if (pos==='_random_') {
          oops.x=Math.floor(Math.random()*481)-240;
          oops.y=Math.floor(Math.random()*361)-180;
        } else {
          oops.x=sprites[pos].x;
          oops.y=sprites[pos].y;
        }
        if (oops.pendown) {
          c.lineTo(oops.x,oops.y);
          c.stroke();
        }
        break;
      case 'putPenUp':
        oops.pendown=false;
        break;
      case 'putPenDown':
        oops.pendown=true;
        c.beginPath();
        c.moveTo(oops.x,oops.y);
        c.lineTo(oops.x,oops.y);
        c.stroke();
        break;
      case 'randomFrom:to:':
        var r1=Number(doscratch(block[1],oops)),
        r2=Number(doscratch(block[2],oops));
        if (r1===r2) return r1;
        else if (r1%1!==0||r2%1!==0) return Math.random()*(r1-r2)+r2;
        else return Math.floor(Math.random()*(r1-r2+1)+r2);
      case 'getParam':
        return doscratch(oops.temp_params[block[1]],oops);
      default:
        //
    }
  }
}
function dothe(code,sprite,parames) {
  var params={};
  for (var i=0;i<code[0][2].length;i++) params[code[0][2][i]]=parames[i];
  sprite.temp_params=params;
  for (var i=1;i<code.length;i++) doscratch(code[i],sprite);
}
var interval;
SHEEP.menu['green flag']=e=>{
  if (scratch) {
    console.log('%c🏴 green flagged','color:green;font-weight:bold;');
    canvas.style.backgroundImage='url(https://cdn.assets.scratch.mit.edu/internalapi/asset/'+scratch.costumes[scratch.currentCostumeIndex].baseLayerMD5+'/get/)';
    if (scratch.variables) for (var i=0;i<scratch.variables.length;i++) sprites._STAGE_.vars[scratch.variables[i].name]=scratch.variables[i].value;
    if (scratch.lists) for (var i=0;i<scratch.lists.length;i++) sprites._STAGE_.lists[scratch.lists[i].listName]=scratch.lists[i].contents;
    sprites._STAGE_.gfs=[];
    sprites._STAGE_.custs=[];
    sprites._STAGE_.code=[];
    sprites._STAGE_.forevers=[];
    if (scratch.scripts) for (var i=0;i<scratch.scripts.length;i++) {
      sprites._STAGE_.code[i]=scratch.scripts[i][2];
      if (scratch.scripts[i][2][0][0]==='whenGreenFlag') sprites._STAGE_.gfs.push(i);
      if (scratch.scripts[i][2][0][0]==='procDef') sprites._STAGE_.custs[scratch.scripts[i][2][0][1]]=i;
    }
    for (var i=0;i<scratch.children.length;i++) {
      if (scratch.children[i].scripts) {
        var data=scratch.children[i],
        name=scratch.children[i].objName;
        sprites[name]={vars:{},lists:{}};
        if (data.variables) for (var i=0;i<data.variables.length;i++) sprites[name].vars[data.variables[i].name]=data.variables[i].value;
        if (data.lists) for (var i=0;i<data.lists.length;i++) sprites[name].lists[data.lists[i].name]=data.lists[i].value;
        sprites[name].x=data.scratchX;
        sprites[name].y=data.scratchY;
        sprites[name].pensize=1;
        sprites[name].pencolour=255;
        sprites[name].pendown=false;
        sprites[name].gfs=[];
        sprites[name].custs=[];
        sprites[name].code=[];
        sprites[name].forevers=[];
        for (var j=0;j<data.scripts.length;j++) {
          sprites[name].code[j]=data.scripts[j][2];
          if (data.scripts[j][2][0][0]==='whenGreenFlag') sprites[name].gfs.push(j);
          if (data.scripts[j][2][0][0]==='procDef') sprites[name].custs[data.scripts[j][2][0][1]]=j;
        }
      }
    }
    canvas.width=canvas.width;
    c.translate(240*pxr,canvas.height-180*pxr);
    c.scale(pxr,-pxr);
    c.lineCap='round';
    c.lineJoin='round';
    for (var span in sprites) {
      if (sprites[span].pensize) c.lineWidth=sprites[span].pensize;
      if (sprites[span].pencolour) c.strokeStyle='#'+('00000'+sprites[span].pencolour.toString(16)).slice(-6);
      for (var i=0;i<sprites[span].gfs.length;i++) {
        var code=sprites[span].code[sprites[span].gfs[i]];
        for (var j=1;j<code.length;j++) doscratch(code[j],sprites[span]);
      }
    }
    interval=setInterval(_=>{
      for (var span in sprites) {
        if (sprites[span].pensize) c.lineWidth=sprites[span].pensize;
        if (sprites[span].pencolour) c.strokeStyle='#'+('00000'+sprites[span].pencolour.toString(16)).slice(-6);
        for (var i=0;i<sprites[span].forevers.length;i++) {
          var code=sprites[span].forevers[i];
          for (var j=0;j<code.length;j++) doscratch(code[j],sprites[span]);
        }
      }
    },1000/30);
    /* c.lineWidth=5;
    c.strokeStyle='blue';
    c.beginPath();
    c.moveTo(125,125);
    c.lineTo(125,45);
    c.lineTo(45,125);
    c.stroke();
    c.beginPath();
    c.moveTo(0,0);
    c.stroke();
    c.lineWidth=1;
    c.beginPath();
    c.moveTo(0,180);
    c.lineTo(0,-180);
    c.moveTo(240,0);
    c.lineTo(-240,0);
    c.stroke(); */
  }
};
SHEEP.menu['stop sign']=e=>clearInterval(interval);
var convertcolours={
  dectohsl(dec) {
    var rgb={r:Math.floor(dec/65536),g:Math.floor(dec/256)%256,b:dec%256,a:Math.floor(dec/16777216)/255||1},
    max=Math.max(rgb.r,rgb.g,rgb.b),min=Math.min(rgb.r,rgb.g,rgb.b),
    h,s,l=(max+min)/2;
    if (max===min) h=s=0;
    else {
      var d=max-min;
      s=l>0.5?d/(2-max-min):d/(max+min);
      switch (max) {
        case rgb.r: h=(rgb.g-rgb.b)/d+(rgb.g<rgb.b?6:0); break;
        case rgb.g: h=(rgb.b-rgb.r)/d+2; break;
        case rgb.b: h=(rgb.r-rgb.g)/d+4; break;
      }
      h/=6;
    }
    return {h:Math.round(h*360),s:Math.round(s*100),l:Math.round(l*100)};
  },
  hsltodec(hsl) {
    var r,g,b;
    hsl={h:hsl.h/360,s:hsl.s/100,l:hsl.l/100};
    if (hsl.s===0) r=g=b=hsl.l;
    else {
      var hue2rgb=(p,q,t)=>{
        if (t<0) t+=1;
        if (t>1) t-=1;
        if (t<1/6) return p+(q-p)*6*t;
        if (t<1/2) return q;
        if (t<2/3) return p+(q-p)*(2/3-t)*6;
        return p;
      };
      var q=hsl.l<0.5?hsl.l*(1+hsl.s):hsl.l+hsl.s-hsl.l*hsl.s,
      p=2*hsl.l-q;
      r=hue2rgb(p,q,hsl.h+1/3);
      g=hue2rgb(p,q,hsl.h);
      b=hue2rgb(p,q,hsl.h-1/3);
    }
    return 65536*Math.floor(255.9999*r)+256*Math.floor(255.9999*g)+Math.floor(255.9999*b);
  }
};
    </script>
  </body>
  <!-- MADE BY SEAN -->
</html>
